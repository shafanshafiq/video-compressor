<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cross-Origin-Opener-Policy" content="same-origin">
    <meta http-equiv="Cross-Origin-Embedder-Policy" content="require-corp">
    <title>Universal Video Compressor</title>
    <style>
        /* [Keep all your existing CSS styles] */
    </style>
</head>
<body>
    <!-- [Keep all your existing HTML structure] -->

    <!-- Updated script section -->
    <script src="https://unpkg.com/@ffmpeg/ffmpeg@0.11.6/dist/ffmpeg.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            // Check for SharedArrayBuffer support
            if (typeof SharedArrayBuffer === 'undefined') {
                alert('This browser doesn\'t support SharedArrayBuffer.\n\n' +
                      'Please use Chrome/Edge 91+ or Firefox 79+ with these requirements:\n' +
                      '1. HTTPS connection\n' +
                      '2. Cross-Origin-Isolation headers\n' +
                      '3. Latest browser version');
                return;
            }

            // Initialize FFmpeg
            const { createFFmpeg, fetchFile } = FFmpeg;
            const ffmpeg = createFFmpeg({ 
                log: true,
                corePath: 'https://unpkg.com/@ffmpeg/core@0.11.0/dist/ffmpeg-core.js'
            });

            // [Keep all your existing variable declarations]

            // Load FFmpeg when page loads
            try {
                await ffmpeg.load();
                console.log('FFmpeg loaded successfully');
            } catch (error) {
                console.error('FFmpeg load error:', error);
                alert('Failed to load FFmpeg. See console for details.');
                return;
            }

            // [Keep all your existing event listeners and functions]
        });
    </script>
</body>
</html>